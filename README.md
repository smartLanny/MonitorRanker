# 显示器天梯图生成器（MonitorRanker）
![monitorranker](https://github.com/user-attachments/assets/dc2c5eed-fe34-4468-af8e-0040f8f3615f)

从CSV文件中轻松加载显示器性能数据，并生成专业、美观、高度可定制的“天梯图”，用于直观比较和展示显示器的各项性能指标。

## 软件截图
下面通过一些截图来展示软件的主要界面和功能：
### 1. 主界面与数据加载
软件启动并加载CSV数据后，可以选择不同的指标来查看对应的天梯图。

![主界面-已加载数据](https://github.com/user-attachments/assets/9ce67d92-82a2-4aea-9ac2-5ac2bc579ca6)

### 2. 指标选择与图表自定义
从下拉列表中选择要分析的显示器指标，并根据需求调整配色、排序逻辑、单位以及是否显示详细信息。

![指标选择与自定义控件](https://github.com/user-attachments/assets/ee19cf64-102a-4215-b325-04286f9ae9a4)

*(上图展示了指标选择下拉框、配色方案、排序逻辑、单位输入框和“显示尺寸和分辨率”复选框)*

### 3. 图表显示效果
图表会清晰地展示各显示器在选定指标下的排名、具体数值以及相关信息。
![MPRT运动响应时间天梯榜](https://github.com/user-attachments/assets/a0ea967d-6e19-4f86-a646-a4cbe9d34f46)


**详细视图:**
![图表详细视图](https://github.com/user-attachments/assets/1f7ab66f-675d-42b0-a48a-3aea5007b56f)

*(上图显示了勾选“显示尺寸和分辨率”后的效果，额外展示了尺寸和分辨率信息，行高也相应调整)*

**预设多种MD主题:**
![Pink&Cyan](https://github.com/user-attachments/assets/15698677-56b0-4099-8c25-8b083678dec6)

*(上图显示了Pink&Cyan主题的风格，内置多种MD主题可选)*

**浅色模式切换:**
![image](https://github.com/user-attachments/assets/b87dc5c5-aed9-4d27-8b1b-f46cb3b4cd84)

*(上图显示了浅色模式排版，导出PNG的配色同样受到影响)*

### 4. 导出功能
将当前图表或所有图表导出为PNG图片。

![导出功能按钮](https://github.com/user-attachments/assets/a1272f22-2b35-4a61-a1f5-3709da432eed)

选择“导出全部PNG”后，程序会提示选择一个文件夹来保存所有生成的图片。

### 5. 最终导出PNG示例
以下是由本软件导出的PNG图片示例，具有较高的清晰度和固定的排版。通过调整DPR比例，可以进一步提高图片分辨率。

![导出PNG示例](https://github.com/user-attachments/assets/bf4f2883-7b6f-48e9-9f1a-0420a5afaed1)

## 主要功能

* **便捷的数据导入**：
    * 支持从 CSV 文件加载数据。
    * 智能尝试多种字符编码（UTF-8, GBK, GB2312, UTF-8-SIG）以确保文件正确读取。
    * 自动清理列名首尾空格。
* **动态指标处理**：
    * 自动发现CSV文件中未预定义的数值列，并将其作为新的可选性能指标。
    * 用户可以为任何指标（预定义或新发现）自定义排序逻辑（值越高越好/值越低越好）和显示的单位后缀。
* **丰富的可视化定制**：
    * **多维度指标选择**：轻松切换不同的性能指标进行可视化。
    * **专业配色方案**：内置多种图表配色方案，一键切换，美化数据呈现。
    * **个性化主题界面**：提供深色与浅色两种UI主题，可通过按钮（☀️/🌙）即时切换，适应不同背景需求。
    * **细节显示控制**：
        * 可选择是否在图表中显示每个显示器的“尺寸”和“分辨率”等详细信息。
        * 可切换数值标签的显示位置（默认在数据条外侧，可选在内侧显示，空间不足时自动调整）。
    * **智能脚注**：自动识别显示器型号名称末尾常见的模式标注（如一些显示器切换到1080p高刷新率模式，显示器名称后跟“(1080p)”的尾缀），并将其作为脚注清晰显示。
* **高质量图像导出**：
    * 支持将当前显示的单个指标天梯图导出为高清晰度、背景透明的 PNG 图片，从而在视频中搭配不同背景。
    * 支持一键批量导出所有可用指标的天梯图（每个指标一张PNG图片）到指定文件夹。
    * 导出图片时进行字体和布局缩放，确保文字清晰，排版美观。
* **用户友好的交互**：
    * 清晰的顶部操作栏和控制面板，功能分区明确。
    * 实时状态栏信息反馈，提示操作结果。
    * 流畅的控件交互和视觉反馈。

## 如何使用

1.  **启动软件**：运行应用程序。
2.  **加载数据**：点击界面右上角的 **“加载 CSV”** 按钮，选择包含显示器数据的CSV文件。
3.  **配置图表**：
    * 在“指标”下拉框中选择您想分析的性能参数。
    * 根据需要调整“排序”（越高越好/越低越好）、“单位”。
    * 在“配色”下拉框中选择喜欢的图表颜色主题。
    * 勾选或取消勾选“显示尺寸和分辨率”以控制图表条目信息的详略。
    * 勾选或取消勾选“数值标签内显”以调整数值标签的显示位置。
4.  **查看与分析**：图表区域将根据您的选择实时更新。
5.  **切换界面主题**：点击界面右上角的 **☀️/🌙** 图标按钮，即可在深色和浅色主题间切换。
6.  **导出图表**：
    * 点击 **“导出当前”** 按钮，保存当前显示的图表为PNG图片。
    * 点击 **“导出全部”** 按钮，选择一个文件夹，软件会将所有指标的图表分别导出为PNG图片。

## 技术栈

* Python
* PyQt6 (图形用户界面)
* Pandas (数据处理)

## 未来目标

* 接入飞书数据库API，实现自动联网更新。
* 支持更多图表类型。
* 增加数据筛选和高级排序功能。
* 提供更丰富的图表导出选项（如自定义DPI，导出PDF）。
